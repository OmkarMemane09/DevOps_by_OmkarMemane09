# üê≥ What is Docker Swarm?

**Docker Swarm is Docker‚Äôs native container orchestration tool.**
*It allows you to create, manage, and scale a cluster of Docker nodes as a single virtual system called a Swarm.*

###### With Swarm, you can:

 - Deploy services across multiple machines

 - Auto-distribute containers

 - Scale horizontally

 - Load-balance traffic

 - Perform rolling updates

**Swarm is built directly into Docker Engine ‚Äî no separate installation needed.**


| Feature | **Kubernetes (K8s)** | **Docker Swarm** |
|--------|------------------------|-------------------|
| **Installation** | Complex setup. Requires configuring components like `etcd`, networking (Flannel/Calico), kube-api, kubelet, controllers etc. | Very easy installation. Docker CE itself includes swarm. A cluster can be created with a single `docker swarm init` command. |
| **CLI & API** | Uses its own YAML syntax, kubectl commands, and API different from Docker‚Äôs. | Uses Docker CLI and Swarm API, familiar to anyone using Docker. |
| **Speed of Deployment** | Slower due to strict state management, reconciliation loops, and heavy architecture. | Faster container deployment and quick scaling even in large clusters. |
| **Load Balancing** | Needs service configuration; Kubernetes Service + Ingress for LB. | Built-in load balancing automatically across nodes once service is deployed. |
| **Updates & Rollbacks** | Does rolling updates pod by pod. Automatic rollback on failure. | Performs rolling updates too; rollback is simple and manual. |
| **Volumes / Storage** | Volumes abstracted at Pod level; multiple containers in a pod share storage. | Docker volumes are simple and can be shared across containers. |
| **Monitoring** | Supports multiple integrations ‚Äî Prometheus, ELK, Grafana, Sysdig, etc. | Limited native monitoring; usually 3rd-party tools. |
| **Networking** | Uses Flannel/Calico/etc. TLS needs manual setup. | Provides built-in multi-host overlay networking with automatic TLS. |
| **Service Discovery** | Uses `etcd` and DNS for service discovery. | Built-in service discovery: every container gets its own virtual IP. |
| **Architecture Complexity** | Very complex and highly flexible; enterprise-grade. | Simple architecture, easy to understand and operate. |
| **Auto-Scaling** | ‚úîÔ∏è Supports automatic scaling (Horizontal Pod Autoscaler). | ‚ùå No auto-scaling ‚Äî scaling is manual. |
---

### Kubernetes is the best choice for large-scale, enterprise-grade orchestration with advanced features, strong scalability, and powerful networking.

### Docker Swarm is ideal for small teams or beginner DevOps engineers who want simple and fast orchestration without complex setup.
### Features
- Cluster Management =	Manage nodes as one virtual Docker host

- Service Scaling	= Scale services up/down anytime

- Load Balancing =	Distributes traffic across replicas

- Self-Healing =	Automatically replaces failed tasks

- Rolling Updates	= Zero-downtime deployments

*Secure by Default	TLS-based encrypted communication*

### Why Docker Swarm?

> Extremely easy to setup

> Uses same Docker commands you already know

> Ideal for learning container orchestration

> Lightweight alternative to Kubernetes

**Perfect for:**

DevOps beginners

Local clusters

Production-lite environments

Microservice projects

### Architecture

```
                    +-------------------------------+
                    |        Manager Node           |
                    |-------------------------------|
                    |  Schedules Services           |
                    |  Maintains Cluster State      |
                    |  Runs RAFT Consensus          |
                    +---------------+---------------+
                                    |
                  ------------------------------------------
                  |                    |                   |
         +--------+--------+ +---------+--------+ +--------+--------+
         |   Worker Node   | |   Worker Node    | |   Worker Node   |
         |------------------| |------------------| |-----------------|
         | Runs Containers  | | Runs Containers  | | Runs Containers |
         | Executes Tasks   | | Executes Tasks   | | Executes Tasks  |
         +------------------+ +------------------+ +-----------------+

```
### Core Components

#### 1. Node

A machine part of the swarm (Manager or Worker).

#### 2. Manager Node

Schedules tasks

Runs RAFT consensus

Manages state of cluster

#### 3. Worker Node

Executes container tasks

Reports health/status to managers

#### 4. Service

A definition of a group of containers (tasks).

#### 5. Task

A single running container instance.

#### 6. Stack

A multi-service application defined using Compose.

### Prerequisites

#### 1 Manager node

#### 1‚Äì2 Worker nodes

Docker installed on all machines

Ubuntu / EC2 / VirtualBox / WSL supported

## Hands-On: Build a Swarm Cluster

### Install Docker on All Nodes
```bash
sudo apt update
sudo apt install docker.io -y
sudo systemctl enable docker
sudo systemctl start docker
```
### Initialize Swarm (Manager)
```bash
docker swarm init --advertise-addr <MANAGER-IP>
```

Example:

```bash
docker swarm init --advertise-addr 192.168.1.10
```

**Swarm outputs a worker join command:**
```bash
docker swarm join --token SWMTKN-1-xyz <MANAGER-IP>:2377
```
### Join Worker Nodes

Run on every worker node:
```bash
docker swarm join --token SWMTKN-1-xyz 192.168.1.10:2377
```
### Verify Node
```bash
docker node ls
```

## Swarm Services & Operations
‚úîÔ∏è Create a Service
docker service create --name webapp -p 8080:80 nginx

‚úîÔ∏è List Services
docker service ls

‚úîÔ∏è Check Service Tasks
docker service ps webapp

‚úîÔ∏è Inspect Service
docker service inspect --pretty webapp

## Scaling & Load Balancing

Scale service replicas:
docker service scale webapp=5


Load-balancing automatically distributes traffic across all replicas.

## Rolling Updates & Rollback
**Update to new image:**
```bash
docker service update --image nginx:latest webapp
```
**Rollback if failed:**
```bash
docker service rollback webapp
```
### Deploy Using Docker Stack

Create docker-compose.yml:
```dockerfile
version: "3"
services:
  frontend:
    image: nginx
    ports:
      - "8080:80"

  backend:
    image: httpd
    ports:
      - "9000:80"
```

* Deploy:
```bash
docker stack deploy -c docker-compose.yml mystack
```

* List stack:
```bash
docker stack ls
```

* Services in stack:
```bash
docker stack services mystack
```

* Remove stack:
```bash
docker stack rm mystack
```
#### Node Management
*List nodes:*
```bash
docker node ls
```
*Drain a node (maintenance):*
```bash
docker node update --availability drain worker1
```
*Activate node:*
```bash
docker node update --availability active worker1
```
*Remove a node:*
```bash
docker node rm worker1
```
### Service Management
*Remove a service:*
```

docker service rm webapp
```

*Update replicas:*
```
docker service update --replicas=10 webapp
```

*Update environment variables:*
```
docker service update --env-add KEY=value webapp
```

### Swarm Networking
*Create an overlay network:*
```
docker network create -d overlay myoverlay
```

*Use in a service:*
```
docker service create --name api --network myoverlay nginx
```


