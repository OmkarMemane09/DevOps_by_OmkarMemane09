# ðŸ“¦ Docker Compose â€“ Complete Notes (Beginner to Advanced)

Docker Compose is a tool that helps you **define and run multi-container Docker applications** using a single file `docker-compose.yml`.

---

## ðŸ”¹ What is Docker Compose?
Docker Compose is a tool that lets you:

- Define multiple services (containers) in one YAML file  
- Run & stop all containers together  
- Manage networking, volumes, dependencies automatically  
- Build reproducible environments  

File used: **`docker-compose.yml`**

---

## ðŸ”¹ Why Use Docker Compose?
| Feature | Why Important |
|--------|--------------|
| Multi-container apps | Run DB + Backend + Frontend together |
| Easy config | All settings inside one file |
| One-command operations | `docker compose up` |
| Environment consistency | Same setup works on all machines |
| Volumes & networks | Automatically created & managed |

---

## ðŸ”§ Installation
### On Linux
```bash
sudo apt install docker-compose-plugin
```
Check version
```bash
docker compose version
```
### docker-compose.yml File Structure
```bash
version: "3.9"

services:
  service_name:
    image: image_name
    ports:
      - "host:container"
    environment:
      KEY: value
    volumes:
      - host_path:container_path
    depends_on:
      - another_service

volumes:
  your_volume:

networks:
  your_network:
```
### Common Keywords Explained
**services**
- Defines containers.

**image**
- Docker image to run or build.

**build**
- Build from Dockerfile (use instead of image).

```bash
build:
  context: .
  dockerfile: Dockerfile
```
**ports**
- Port mapping:

```bash
- "8080:80"
```
**environment**
- Set environment variables.

**env_file**
- Load variables from .env:

```bash
env_file:
  - .env
```
**volumes**
- Persistent storage.

**depends_on**
- Start order of containers.

**networks**
- Custom network for service communication.

### Basic Example â€“ Running 1 Service
```bash
version: "3.9"

services:
  web:
    image: nginx:latest
    ports:
      - "8080:80"
```
*Run it:*
```bash
docker compose up -d
```
*Stop it:*

```bash
docker compose down
```
#### Multi-Container Example (Web + DB)
```bash
version: "3.9"

services:
  web:
    build: .
    ports:
      - "8080:80"
    depends_on:
      - db

  db:
    image: mysql:8
    environment:
      MYSQL_ROOT_PASSWORD: rootpass
      MYSQL_DATABASE: appdb
    volumes:
      - dbdata:/var/lib/mysql

volumes:
  dbdata:
```

##### How it works?

- MySQL starts first

- Web app waits for DB using depends_on

- DB data stored in volume dbdata

#### Docker Compose Commands

**Start all services**
```bash
docker compose up
```
**Run in background (detached)**
```bash
docker compose up -d
```
**Stop all services**
```bash
docker compose down
```
**See logs**
```bash
docker compose logs -f
```
**Rebuild containers**
```bash
docker compose up --build
```
**List services**
```bash
docker compose ps
```
**Stop a single service**
```bash
docker compose stop service_name
```
### Environment Variables in Compose

*Using .env file*
.env
```bash
DB_USER=root
DB_PASS=password
```
**docker-compose.yml**

```bash
environment:
  - MYSQL_USER=${DB_USER}
  - MYSQL_PASSWORD=${DB_PASS}
Use:
```
```bash
docker compose up
```
### Volumes in Docker Compose
Declaring volumes
```bash
volumes:
  dbdata:
```
Using volumes
```bash
volumes:
  - dbdata:/var/lib/mysql
```
**Types of volumes**

Named volume	dbdata:/var/lib/mysql
Host volume	./data:/var/lib/mysql

### Networks in Docker Compose
**Default Network**
Compose automatically creates one network for all services.

**Custom networks**
```bash
networks:
  app_net:

services:
  web:
    networks:
      - app_net
  db:
    networks:
      - app_net
```
### Scaling Services
For load balancing or replicas:
```bash
docker compose up --scale web=3 -d
```
You can scale any stateless service.
